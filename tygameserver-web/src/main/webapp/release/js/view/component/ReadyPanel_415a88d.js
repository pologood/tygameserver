puremvc.define({name:"drawsomething.view.component.ReadyPanel",constructor:function(){var t=this;this.kickPlayerId,this.container=document.querySelector("#readyPanel"),this.$container=$("#readyPanel"),this.$container.find(".startBtn").click(function(){$(this).hasClass("gray")||t.startGame()}),this.$container.click(function(e){if($(e.target).hasClass("btn-ready"))t.setReady();else if($(e.target).hasClass("closeBtn")){var n=$(e.target).attr("data-avatarId");t.kickPlayerId=n,t.$confirmPop.show()}}),this.$container.bind("countDown",function(){t.setReady()}),this.items=[],this.$confirmPop=this.$container.find(".confirmPop"),this.$confirmPop.find(".cancelBtn").click(function(){t.$confirmPop.hide()}),this.$confirmPop.find(".confirmBtn").click(function(){t.kickPlayer(t.kickPlayerId)})}},{addEventListener:function(t,e,n){drawsomething.view.event.AppEvents.addEventListener(this.container,t,e,n)},createEvent:function(t){return drawsomething.view.event.AppEvents.createEvent(t)},dispatchEvent:function(t){drawsomething.view.event.AppEvents.dispatchEvent(this.container,t)},initRoom:function(t){this.$container.find(".playerList").empty();for(var e=t.info.members,n=0;n<e.length;n++){var i=new drawsomething.view.component.PlayerItem;i.update(e[n],t.roominfo,t.avatarId),this.items.push(i),this.$container.find(".playerList").append(i.el),t.avatarId==e[n].avatarId&&t.avatarId!=t.roominfo.ownerId&&i.startCountDown()}this.$container.find(".roomId").html("\u623f\u95f4\u53f7\uff1a"+t.info.id),t.roominfo.ownerId==t.avatarId?this.$container.find(".startBtn").show():this.$container.find(".startBtn").hide(),this.updateStartBtn()},addPlayer:function(t){var e=new drawsomething.view.component.PlayerItem;e.update(t.member.avatar,t.roominfo,t.avatarId),this.items.push(e),this.$container.find(".playerList").append(e.el),this.updateStartBtn()},updateReadyInfo:function(t){for(var e=t.info.avatar.avatarId,n=0;n<this.items.length;n++)this.items[n].avatarId==e&&this.items[n].ready();this.updateStartBtn()},updateMembers:function(){},startGame:function(){var t=this.createEvent(drawsomething.view.event.AppEvents.START_GAME);t.msg={},this.dispatchEvent(t)},setReady:function(){var t=this.createEvent(drawsomething.view.event.AppEvents.READY);t.msg={},this.dispatchEvent(t)},kickPlayer:function(t){var e=this.createEvent(drawsomething.view.event.AppEvents.REMOVE_PLAYER);e.msg={avatarId:t},this.dispatchEvent(e)},receiveRemovePlayer:function(t){for(var e=this.items.length-1;e>=0;e--)t.avatarId==this.items[e].avatarId&&(this.items[e].remove(),this.items.splice(e,1));this.$container.find(".confirmPop").hide()},updateStartBtn:function(){for(var t=0,e=0;e<this.items.length;e++)this.items[e].isReady&&t++;t>=2&&t==this.items.length?this.$container.find(".startBtn").removeClass("gray"):this.$container.find(".startBtn").addClass("gray")},hide:function(){this.$container.hide()},show:function(){this.$container.show()}},{NAME:"ReadyPanel"});